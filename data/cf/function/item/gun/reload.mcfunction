execute on origin run item modify entity @s weapon.mainhand [{function:"minecraft:set_components",components:{"!minecraft:custom_data":{}},conditions:[{condition:"minecraft:entity_properties",entity:"this",predicate:{slots:{weapon.mainhand:{predicates:{"minecraft:container":{items:{count:[{test:{},count:0}]}}}}}}}]},{function:"minecraft:modify_contents",component:"minecraft:container",modifier:{function:"minecraft:set_count",count:-1,add:true}},{function:"minecraft:set_components",components:{"minecraft:charged_projectiles":[{id:"minecraft:spectral_arrow"}]},conditions:[{condition:"minecraft:inverted",term:{condition:"minecraft:entity_properties",entity:"this",predicate:{slots:{weapon.mainhand:{predicates:{"minecraft:container":{items:{count:[{test:{},count:0}]}}}}}}}}]}]